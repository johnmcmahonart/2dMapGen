added serialization and fixed select generator